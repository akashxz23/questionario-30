<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Desafio 30 Dias de Hobbies</title>
  <meta name="description" content="Complete 20 hobbies em 30 dias. Escolha 20 dentre 60, acompanhe o progresso e receba sugest√µes de atividades para cada hobby." />
  <style>
    :root{
      --bg: #0f1225;
      --card: #171a34;
      --muted: #a9b0d0;
      --text: #eef1ff;
      --primary: #6e76ff;
      --primary-2: #a76dff;
      --accent: #2ee6a6;
      --danger: #ff5f7a;
      --warning: #ffbe3d;
      --radius: 18px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(167,109,255,.18), transparent 50%),
        radial-gradient(1000px 500px at 90% 10%, rgba(110,118,255,.18), transparent 50%),
        linear-gradient(180deg, #0b0e1e, #121532 35%, #0f1225);
    }
    a{color:inherit}
    .container{max-width:1100px;margin:0 auto;padding:24px}

    header{
      position:sticky;top:0;z-index:20;
      backdrop-filter:saturate(140%) blur(10px);
      background:linear-gradient(180deg, rgba(15,18,37,.9), rgba(15,18,37,.55));
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--primary),var(--primary-2));box-shadow:0 6px 18px rgba(110,118,255,.45)}
    .title{font-weight:800;letter-spacing:.3px}

    .wrap{display:grid;gap:18px}
    @media(min-width:860px){.wrap{grid-template-columns:1.2fr .8fr;align-items:start}}

    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border:1px solid rgba(255,255,255,.07);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:22px;
    }
    .hero{display:grid;gap:16px;text-align:center;padding:36px}
    .hero h1{font-size:clamp(28px,3.5vw,44px);margin:6px 0 0 0}
    .hero p{color:var(--muted);margin:6px 0 0 0}

    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      border:none;cursor:pointer;border-radius:999px;padding:14px 18px;font-weight:700;
      background:linear-gradient(135deg,var(--primary),var(--primary-2));
      color:white;box-shadow:0 12px 24px rgba(110,118,255,.35);
      transition:transform .12s ease, box-shadow .12s ease, filter .2s ease;
    }
    .btn:hover{transform:translateY(-1px);box-shadow:0 14px 26px rgba(110,118,255,.45)}
    .btn:active{transform:translateY(0)}
    .btn.secondary{background:#20244a;color:var(--text);box-shadow:none;border:1px solid rgba(255,255,255,.08)}
    .btn.danger{background:linear-gradient(135deg,#ff6b8a,#ff4d6d);box-shadow:0 12px 24px rgba(255,99,132,.3)}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,.14)}

    .hidden{display:none !important}
    .center{text-align:center}

    .kpis{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
    .kpi{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.07);border-radius:16px;padding:16px}
    .kpi .label{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.6px}
    .kpi .value{font-size:26px;font-weight:900;margin-top:6px}

    /* Sele√ß√£o */
    .grid{display:grid;grid-template-columns:repeat(1,1fr);gap:12px}
    @media(min-width:600px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(min-width:920px){.grid{grid-template-columns:repeat(3,1fr)}}

    .hobby-item{display:flex;gap:12px;align-items:flex-start;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);padding:14px;border-radius:14px}
    .hobby-item input{margin-top:2px;transform:scale(1.15)}
    .hobby-name{font-weight:700}
    .hobby-actions{margin-left:auto;display:flex;gap:8px}

    /* Dashboard */
    .dash-header{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between}
    .progress-wrap{width:100%;height:14px;background:#23264d;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.08)}
    .progress-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),#83f6cf);transition:width .35s ease}
    .progress-label{display:flex;justify-content:space-between;color:var(--muted);font-size:13px;margin-top:8px}

    .hobby-card{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.07);border-radius:16px;padding:16px;display:grid;gap:10px;box-shadow:var(--shadow)}
    .hobby-card header{display:flex;gap:10px;align-items:center;justify-content:space-between}
    .pill{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);color:var(--muted)}
    .done{background:linear-gradient(135deg, #2ee6a6, #7df5d1);color:#0a1a11}

    details.suggestions{border-top:1px dashed rgba(255,255,255,.12);padding-top:8px}
    details.suggestions summary{cursor:pointer;list-style:none}
    details.suggestions summary::-webkit-details-marker{display:none}
    ul.suggest{margin:8px 0 0 18px;color:#cbd4ff}

    .countdown{font-variant-numeric:tabular-nums;letter-spacing:.5px}

    .footer{color:var(--muted);font-size:12px;text-align:center;margin:24px 0}
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 24px">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title">Desafio 30 Dias de Hobbies</div>
      </div>
      <div id="nav-actions" class="brand">
        <button id="btn-reset" class="btn ghost" title="Reiniciar desafio">Reiniciar</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- HOME -->
    <section id="view-home" class="card hero">
      <h1>Voc√™ tem <span style="color:var(--accent)">30 dias</span> para realizar <span style="color:var(--primary-2)">20 hobbies</span>.</h1>
      <p>Escolha 20 entre 60 op√ß√µes, acompanhe seu progresso com sugest√µes de atividades para cada hobby, e conclua o desafio antes do tempo acabar. Tudo fica salvo no seu navegador.</p>
      <div>
        <button id="btn-start" class="btn" aria-label="Iniciar Desafio">Iniciar Desafio</button>
      </div>
      <div class="kpis" id="resume" style="display:none">
        <div class="kpi">
          <div class="label">Hobbies conclu√≠dos</div>
          <div class="value" id="resume-completed">0/20</div>
        </div>
        <div class="kpi">
          <div class="label">Tempo restante</div>
          <div class="value countdown" id="resume-left">‚Äî</div>
        </div>
      </div>
    </section>

    <!-- SELE√á√ÉO -->
    <section id="view-select" class="card hidden">
      <h2 style="margin:0 0 8px 0">Selecione 20 hobbies</h2>
      <p class="muted" style="color:var(--muted);margin-top:0">Dica: toque em ‚ÄúSugest√µes‚Äù para ver ideias de atividades antes de escolher.</p>
      <div style="display:flex;align-items:center;gap:10px;margin:8px 0 14px 0">
        <div class="pill" id="count-selected">0/20 selecionados</div>
        <div style="margin-left:auto"></div>
        <button id="btn-confirm" class="btn secondary" disabled>Confirmar sele√ß√£o</button>
      </div>
      <div id="select-grid" class="grid"></div>
    </section>

    <!-- DASHBOARD -->
    <section id="view-dash" class="hidden">
      <div class="card">
        <div class="dash-header">
          <h2 style="margin:0">Seu desafio</h2>
          <div class="pill countdown" id="countdown">30d 00:00:00</div>
        </div>
        <div class="progress-wrap" aria-label="Barra de progresso do desafio">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <div class="progress-label"><span id="progress-text">0/20 conclu√≠dos</span><span id="progress-percent">0%</span></div>
      </div>

      <div id="dash-grid" class="grid" style="margin-top:16px"></div>
    </section>

    <!-- RESULTADO -->
    <section id="view-result" class="card hidden center">
      <h2 id="result-title">Resultado</h2>
      <p id="result-msg" style="color:var(--muted)">‚Äî</p>
      <div style="margin-top:8px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
        <button id="btn-try-again" class="btn">Come√ßar de novo</button>
        <button id="btn-share" class="btn secondary">Compartilhar progresso</button>
      </div>
    </section>

    <p class="footer">Feito com foco em simplicidade, motiva√ß√£o e progresso constante. üí™</p>
  </main>

  <script>
  // ------------------------ Dados base ------------------------
  const HOBBIES = [
    { name: "Desenho", tips: ["Fa√ßa um esbo√ßo de 10 minutos de um objeto da sua casa","Experimente desenhar com a m√£o n√£o dominante","Copie um quadro famoso em estilo simplificado"] },
    { name: "Pintura aquarela", tips: ["Pinte um c√©u em degrad√™","Fa√ßa 3 mini-paisagens em cart√µes","Teste molhado sobre molhado com 2 cores"] },
    { name: "Fotografia", tips: ["Desafio de 5 fotos em preto e branco","Retrato de algu√©m com luz de janela","Foto macro de um objeto pequeno"] },
    { name: "Caminhada", tips: ["Caminhe 3 km no bairro","Capte 3 sons da natureza","Descubra uma rua que voc√™ nunca percorreu"] },
    { name: "Corrida", tips: ["1 km cont√≠nuo em ritmo confort√°vel","Treino de intervalos 4√ó1min","Alongamento p√≥s-corrida de 10 minutos"] },
    { name: "Yoga", tips: ["Sequ√™ncia de 15 minutos para mobilidade","Postura do guerreiro por 60s","Respira√ß√£o 4-7-8 por 5 minutos"] },
    { name: "Medita√ß√£o", tips: ["Medite 5 minutos guiado","Fa√ßa um body scan r√°pido","Agrade√ßa 3 coisas do dia"] },
    { name: "Leitura", tips: ["Leia 20 p√°ginas","Comece um conto curto","Fa√ßa anota√ß√µes de 3 ideias"] },
    { name: "Escrita criativa", tips: ["Microconto de 100 palavras","Di√°logo entre dois objetos","Reescreva um final alternativo"] },
    { name: "Jardinagem", tips: ["Plante ervas em vasos","Propague uma suculenta","Fa√ßa adubo l√≠quido com cascas"] },
    { name: "Culin√°ria", tips: ["Fa√ßa uma receita com 5 ingredientes","Experimente um prato de outra cultura","Aprenda um corte novo"] },
    { name: "Panifica√ß√£o", tips: ["Asse p√£ezinhos r√°pidos","Cookies com 30 min de preparo","Tente fermento natural (starter)"] },
    { name: "Caf√© especial", tips: ["Brew V60 15g/250ml","Prove caf√© gelado (cold brew)","Ajuste a moagem e compare"] },
    { name: "Ch√°", tips: ["Experimente 3 infus√µes diferentes","Fa√ßa ch√° gelado","Monte um blend de ervas"] },
    { name: "Origami", tips: ["Dobre um tsuru","Fa√ßa uma caixa de presente","Crie um marcador de p√°gina"] },
    { name: "Quebra-cabe√ßa", tips: ["Resolva 50 pe√ßas","Fa√ßa por 20 minutos","Separe por cores primeiro"] },
    { name: "Xadrez", tips: ["Treine 3 t√°ticas","Jogue 1 partida r√°pida online","Estude finais b√°sicos"] },
    { name: "Board games", tips: ["Aprenda um jogo novo","Ensine regras a algu√©m","Partida cooperativa"] },
    { name: "Viol√£o", tips: ["Aprenda 3 acordes novos","Toque 1 m√∫sica inteira","Pratique batidas por 10 min"] },
    { name: "Teclado musical", tips: ["Escala maior por 5 min","Acompanhe com metr√¥nomo","Aprenda 1 riff cl√°ssico"] },
    { name: "Canto", tips: ["Aquecimento vocal 8 min","Grave e se ou√ßa","Aprenda 1 m√∫sica simples"] },
    { name: "Podcast", tips: ["Esboce pauta de 5 t√≥picos","Grave 3 minutos de teste","Edite retirando ru√≠dos"] },
    { name: "V√≠deo/YouTube", tips: ["Storyboard de 6 quadros","Grave com luz natural","Edite um corte de 30s"] },
    { name: "Anima√ß√£o stop motion", tips: ["Curta de 5 segundos","Use massa de modelar","Teste 12fps simples"] },
    { name: "Programa√ß√£o", tips: ["Replique um layout em HTML/CSS","Resolva 3 desafios no site de sua escolha","Automatize uma tarefa pequena"] },
    { name: "Rob√≥tica", tips: ["Monte um LED piscante","Teste um sensor de dist√¢ncia","Esboce um carrinho line follower"] },
    { name: "Eletr√¥nica", tips: ["Aprenda a usar mult√≠metro","Monte um divisor de tens√£o","Solda 3 pontos em placa sucata"] },
    { name: "Modelismo", tips: ["Monte um kit simples","Pinte detalhes com pincel fino","Aplique decalques com cuidado"] },
    { name: "Astronomia", tips: ["Observe a Lua a olho nu","Aprenda 3 constela√ß√µes","Registre uma foto do c√©u"] },
    { name: "Caligrafia", tips: ["Pratique 2 alfabetos","Fa√ßa um cart√£o escrito √† m√£o","Experimente brush lettering"] },
    { name: "Lettering", tips: ["3 estilos em uma palavra","Sombra e contorno","Fa√ßa um poster A5"] },
    { name: "Costura", tips: ["Costure um saquinho simples","Ajuste uma barra","Aprenda ponto invis√≠vel"] },
    { name: "Croch√™", tips: ["Fa√ßa um square b√°sico","Aprenda ponto alto e baixo","Crie um marcador de livros"] },
    { name: "Tric√¥", tips: ["Amostra 10√ó10 cm","Pontos meia e tric√¥","Inicie um cachecol"] },
    { name: "Bordado", tips: ["3 pontos: haste, cheio, n√≥ franc√™s","Mini bordado 5cm","Personalize uma pe√ßa"] },
    { name: "Marcenaria", tips: ["Lixe e envernize uma t√°bua","Fa√ßa uma prateleira pequena","Corte reto com serrote"] },
    { name: "Cer√¢mica", tips: ["Modele um vasinho","Experimente textura com folhas","Pinte e esmalte simples"] },
    { name: "Escultura", tips: ["Mini escultura em argila","Experimente plastilina","Estudo de m√£os"] },
    { name: "Grafite", tips: ["Sketch em caderno","Pratique tra√ßos com caneta posca","Exerc√≠cio de sombreamento"] },
    { name: "Acr√≠lica", tips: ["Camadas opacas","Paleta de 3 cores","Pinte um objeto met√°lico"] },
    { name: "Aquarela digital", tips: ["Pinc√©is texturizados","Estudo de pele","Cart√£o digital"] },
    { name: "Ilustra√ß√£o vetorial", tips: ["Recrie um √≠cone","Use Pathfinder","Crie 3 adesivos"] },
    { name: "Design de UI", tips: ["Refa√ßa uma tela famosa","Crie um moodboard","Prototipe uma microintera√ß√£o"] },
    { name: "Fotografia mobile", tips: ["HDR vs normal","Retrato com luz lateral","Panorama urbano"] },
    { name: "Skate", tips: ["Subir e descer com seguran√ßa","Aprenda um ollie baixo","Treine curvas largas"] },
    { name: "Ciclismo", tips: ["5 km em ritmo leve","Ajuste de selim","Fa√ßa manuten√ß√£o da corrente"] },
    { name: "Nata√ß√£o", tips: ["200m nado livre","Treino de respiro bilateral","Prancha 3√ó30s"] },
    { name: "Alongamento", tips: ["10 min corpo todo","Alongue isquiotibiais","Mobilidade de ombro"] },
    { name: "Pilates", tips: ["Cem modificado","Ponte de ombros","Alongamento do gato"] },
    { name: "Dan√ßa", tips: ["Aprenda 1 combo curto","Dance 10 min livre","Siga um tutorial online"] },
    { name: "Karaok√™", tips: ["Escolha 2 m√∫sicas","Aque√ßa a voz","Fa√ßa um dueto"] },
    { name: "Idiomas", tips: ["10 min flashcards","Ou√ßa 1 podcast curto","Escreva 5 frases novas"] },
    { name: "Astronomia urbana", tips: ["Observe planetas vis√≠veis","Use app para localizar constela√ß√µes","Foto da Lua com celular"] },
    { name: "Voluntariado", tips: ["Doe roupas que n√£o usa","Ajude em projeto local","Divulgue uma causa"] },
    { name: "Minimalismo", tips: ["Destralhe 10 itens","Organize 1 gaveta","Revise suas assinaturas"] },
    { name: "Finan√ßas pessoais", tips: ["Revise gastos da semana","Crie meta SMART","Monte uma planilha simples"] },
    { name: "Mindfulness", tips: ["Caminhada consciente 5 min","Coma com aten√ß√£o plena","Pausa de respira√ß√£o 3√ó/dia"] },
    { name: "Leitura em voz alta", tips: ["Leia 5 min para algu√©m","Grave um trecho","Treine dic√ß√£o com trava-l√≠nguas"] },
    { name: "Teatro", tips: ["Exerc√≠cio de improviso","Leia uma cena","Estude express√£o corporal"] },
    { name: "Magia de cartas", tips: ["Aprenda 1 controle","Pratique embaralhamento faro","Apresente para 1 pessoa"] },
    { name: "Astrofotografia b√°sica", tips: ["Fotografe a Lua","Use trip√© e timer","Empilhe 5 fotos"] },
    { name: "Geocaching", tips: ["Crie conta e pesquise pr√≥ximos","Prepare kit b√°sico","Encontre 1 cache"] },
  ];

  const LIMIT = 20;
  const DURATION_DAYS = 30;
  const STORAGE_KEY = 'd30-hobbies-state-v1';

  // ------------------------ Estado ------------------------
  const State = {
    startedAt: null, // timestamp
    deadline: null, // timestamp
    selected: [], // [{name, tips, done, doneAt}]
  };

  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return null;
      const s = JSON.parse(raw);
      if(s && Array.isArray(s.selected)) return s;
      return null;
    }catch(e){return null}
  }
  function saveState(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(State));
  }
  function resetAll(){
    localStorage.removeItem(STORAGE_KEY);
    location.reload();
  }

  // ------------------------ Navega√ß√£o/Views ------------------------
  const $ = (q,root=document)=>root.querySelector(q);
  const $$ = (q,root=document)=>[...root.querySelectorAll(q)];
  const views = {home:$('#view-home'), select:$('#view-select'), dash:$('#view-dash'), result:$('#view-result')};
  function show(id){
    Object.values(views).forEach(v=>v.classList.add('hidden'));
    views[id].classList.remove('hidden');
  }

  // ------------------------ Home ------------------------
  $('#btn-start').addEventListener('click', ()=>{
    const existing = loadState();
    if(existing){
      Object.assign(State, existing);
      hydrateDashboard();
      show('dash');
      return;
    }
    show('select');
    renderSelection();
  });

  // Resume box if existing
  (function initHome(){
    const s = loadState();
    if(!s) return;
    $('#resume').style.display='grid';
    const done = s.selected.filter(h=>h.done).length;
    $('#resume-completed').textContent = `${done}/${LIMIT}`;
    updateCountdownLabels(s.deadline, $('#resume-left'));
  })();

  // ------------------------ Sele√ß√£o ------------------------
  function renderSelection(){
    const grid = $('#select-grid');
    grid.innerHTML='';
    HOBBIES.forEach((hobby, idx)=>{
      const item = document.createElement('div');
      item.className='hobby-item';
      item.innerHTML = `
        <input type="checkbox" id="h${idx}" data-idx="${idx}"/>
        <label for="h${idx}" style="flex:1">
          <div class="hobby-name">${hobby.name}</div>
          <details class="suggestions" style="margin-top:6px">
            <summary class="pill">Sugest√µes üí°</summary>
            <ul class="suggest">
              ${hobby.tips.map(t=>`<li>${t}</li>`).join('')}
            </ul>
          </details>
        </label>
        <div class="hobby-actions">
          <button class="btn ghost btn-tip" type="button">Ver sugest√µes</button>
        </div>`;
      grid.appendChild(item);

      item.querySelector('.btn-tip').addEventListener('click',()=>{
        const det = item.querySelector('details');
        det.open = !det.open;
      });
    });

    grid.addEventListener('change', onChangeSelection);
  }

  function onChangeSelection(){
    const checked = $$('#select-grid input[type="checkbox"]:checked');
    if(checked.length > LIMIT){
      // desmarcar √∫ltimo
      const last = checked[checked.length-1];
      last.checked = false;
      return;
    }
    $('#count-selected').textContent = `${checked.length}/${LIMIT} selecionados`;
    $('#btn-confirm').disabled = checked.length !== LIMIT;
  }

  $('#btn-confirm').addEventListener('click', ()=>{
    const selectedIdx = $$('#select-grid input[type="checkbox"]:checked').map(el=>+el.dataset.idx);
    State.selected = selectedIdx.map(i=>({ name: HOBBIES[i].name, tips: HOBBIES[i].tips, done:false, doneAt:null }));
    const now = Date.now();
    State.startedAt = now;
    State.deadline = now + DURATION_DAYS*24*60*60*1000;
    saveState();
    hydrateDashboard();
    show('dash');
  });

  // ------------------------ Dashboard ------------------------
  let countdownTimer = null;

  function hydrateDashboard(){
    // grid
    const grid = $('#dash-grid');
    grid.innerHTML='';
    State.selected.forEach((h, i)=>{
      const card = document.createElement('div');
      card.className='hobby-card';
      const status = h.done ? '<span class="pill done">Conclu√≠do</span>' : '<span class="pill">Pendente</span>';
      card.innerHTML = `
        <header>
          <strong>${h.name}</strong>
          ${status}
        </header>
        <details class="suggestions">
          <summary class="pill">Sugest√µes para praticar üí°</summary>
          <ul class="suggest">${h.tips.map(t=>`<li>${t}</li>`).join('')}</ul>
        </details>
        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <button class="btn ${h.done? 'secondary' : ''}" data-idx="${i}" ${h.done? 'aria-pressed="true"' : ''}>${h.done? 'Desfazer' : 'Conclu√≠do ‚úÖ'}</button>
          ${h.done? `<span class="pill">Feito em ${new Date(h.doneAt).toLocaleDateString()}</span>` : ''}
        </div>`;
      grid.appendChild(card);
    });

    grid.addEventListener('click', (e)=>{
      const btn = e.target.closest('button.btn');
      if(!btn) return;
      const i = +btn.dataset.idx;
      const h = State.selected[i];
      h.done = !h.done;
      h.doneAt = h.done ? Date.now() : null;
      saveState();
      updateProgressUI();
      hydrateDashboard(); // re-render para refletir status
      maybeFinish();
    }, { once: true });

    updateProgressUI();

    // countdown
    clearInterval(countdownTimer);
    countdownTimer = setInterval(()=>{
      updateCountdownLabels(State.deadline, $('#countdown'));
      if(Date.now() >= State.deadline){
        clearInterval(countdownTimer);
        maybeFinish(true);
      }
    }, 1000);
    updateCountdownLabels(State.deadline, $('#countdown'));
  }

  function updateProgressUI(){
    const done = State.selected.filter(h=>h.done).length;
    const pct = Math.round((done / LIMIT) * 100);
    $('#progress-bar').style.width = pct + '%';
    $('#progress-text').textContent = `${done}/${LIMIT} conclu√≠dos`;
    $('#progress-percent').textContent = pct + '%';
    saveState();
  }

  function updateCountdownLabels(deadline, el){
    const now = Date.now();
    const left = Math.max(0, deadline - now);
    const totalSec = Math.floor(left/1000);
    const days = Math.floor(totalSec / 86400);
    const hours = Math.floor((totalSec % 86400) / 3600).toString().padStart(2,'0');
    const mins = Math.floor((totalSec % 3600) / 60).toString().padStart(2,'0');
    const secs = Math.floor(totalSec % 60).toString().padStart(2,'0');
    el.textContent = `${days}d ${hours}:${mins}:${secs}`;
  }

  function maybeFinish(timeout=false){
    const done = State.selected.filter(h=>h.done).length;
    if(done >= LIMIT){
      showResult(true, done);
      return true;
    }
    if(timeout || Date.now() >= State.deadline){
      showResult(false, done);
      return true;
    }
    return false;
  }

  function showResult(completed, done){
    show('result');
    const title = $('#result-title');
    const msg = $('#result-msg');
    if(completed){
      title.textContent = 'Parab√©ns! üéâ';
      msg.textContent = `Voc√™ concluiu os ${LIMIT} hobbies dentro dos ${DURATION_DAYS} dias. Incr√≠vel!`;
    } else {
      title.textContent = 'Desafio encerrado';
      msg.textContent = `Voc√™ concluiu ${done}/${LIMIT} hobbies em ${DURATION_DAYS} dias. Que tal tentar novamente?`;
    }
  }

  // ------------------------ A√ß√µes globais ------------------------
  $('#btn-reset').addEventListener('click', ()=>{
    if(confirm('Tem certeza que deseja reiniciar o desafio? Todo o progresso ser√° apagado.')) resetAll();
  });

  $('#btn-try-again').addEventListener('click', ()=>{ resetAll(); });

  $('#btn-share').addEventListener('click', async ()=>{
    const done = State.selected.filter(h=>h.done).length;
    const text = `Meu progresso no Desafio 30 Dias de Hobbies: ${done}/${LIMIT} conclu√≠dos!`;
    try{
      if(navigator.share){ await navigator.share({text, title: document.title}); }
      else{
        await navigator.clipboard.writeText(text);
        alert('Texto copiado! Cole onde quiser e compartilhe.');
      }
    }catch(e){ /* ignorar */ }
  });

  // Auto-continuar se j√° existir estado
  (function boot(){
    const s = loadState();
    if(!s) return;
    Object.assign(State, s);
    hydrateDashboard();
    show('dash');
  })();
  </script>
</body>
</html>
